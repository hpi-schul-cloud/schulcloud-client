---
version: \"3.7\"

services:

  ### HPI Schul-Cloud Client
  ###
  client:
    image: schulcloud/schulcloud-client:$DOCKERTAG
    deploy:
      replicas: 1
      restart_policy:
        condition: any
      resources:
        limits:
          cpus: '1'
          memory: 1024M
        reservations:
          cpus: '0.1'
          memory: 1024M
    depends_on:
      - server
    environment:
      # ENV
      - NODE_ENV=production
      - CALENDAR_SERVICE_ENABLED=true
      #- TZ=Europe/Berlin
      # FEATURE TOGGLES
      - FEATURE_TEAMS_ENABLED=true
      # Theme and Titles
      - SC_THEME=default
      - SC_TITLE=HPI Schul-Cloud
      - SC_SHORT_TITLE=HPI Schul-Cloud
      - SC_PRODUCTNAME=HPI Schul-Cloud
      # Nexboard
      - NEXBOARD_API_KEY=$NEXBOARD_API_KEY
      - NEXBOARD_USER_ID=$NEXBOARD_USER_ID
      # URIs
      - HOST=$HOSTSTAGE
      - BACKEND_URL=$BACKEND_URLSTAGE
      - PUBLIC_BACKEND_URL=$PUBLIC_BACKEND_URLSTAGE
      - LIBRE_OFFICE_CLIENT_URL=$LIBRE_OFFICE_CLIENT_URLSTAGE
      # Rocketchat
      - ROCKET_CHAT_URI=ROCKET_CHAT_URISTAGE
      - ROCKETCHAT_SERVICE_ENABLED=true
    ports:
      - \"3100:3100\"
    restart: always
